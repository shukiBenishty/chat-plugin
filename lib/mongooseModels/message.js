"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _mongoose = _interopRequireDefault(require("mongoose"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var Schema = _mongoose["default"].Schema;
var messageSchema = new Schema({
  author: {
    type: Schema.Types.ObjectId,
    ref: 'User',
    required: true,
    index: true
  },
  data: {
    type: Object,
    required: true
  },
  dateSended: {
    type: Date,
    "default": Date.now,
    required: true
  },
  received: {
    type: Boolean,
    "default": false,
    required: true
  },
  readed: {
    type: Boolean,
    "default": false,
    required: true
  },
  destination: {
    type: Schema.Types.ObjectId,
    required: true,
    refPath: 'destinationModel',
    index: true
  },
  destinationModel: {
    type: String,
    "enum": ['User', 'Group']
  },
  createdAt: Date,
  updatedAt: Date,
  isDeleted: {
    type: Boolean,
    "default": false,
    required: true
  }
});
messageSchema.pre('save', function (next) {
  var currentDate = new Date();
  this.updatedAt = currentDate;
  if (!this.createdAt) this.createdAt = currentDate;
  next();
});

var _default = function _default(db) {
  db.model('Message', messageSchema);
};

exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tb25nb29zZU1vZGVscy9tZXNzYWdlLmpzIl0sIm5hbWVzIjpbIlNjaGVtYSIsIm1vbmdvb3NlIiwibWVzc2FnZVNjaGVtYSIsImF1dGhvciIsInR5cGUiLCJUeXBlcyIsIk9iamVjdElkIiwicmVmIiwicmVxdWlyZWQiLCJpbmRleCIsImRhdGEiLCJPYmplY3QiLCJkYXRlU2VuZGVkIiwiRGF0ZSIsIm5vdyIsInJlY2VpdmVkIiwiQm9vbGVhbiIsInJlYWRlZCIsImRlc3RpbmF0aW9uIiwicmVmUGF0aCIsImRlc3RpbmF0aW9uTW9kZWwiLCJTdHJpbmciLCJjcmVhdGVkQXQiLCJ1cGRhdGVkQXQiLCJpc0RlbGV0ZWQiLCJwcmUiLCJuZXh0IiwiY3VycmVudERhdGUiLCJkYiIsIm1vZGVsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7Ozs7QUFDQSxJQUFNQSxNQUFNLEdBQUdDLHFCQUFTRCxNQUF4QjtBQUVBLElBQU1FLGFBQWEsR0FBRyxJQUFJRixNQUFKLENBQVc7QUFDN0JHLEVBQUFBLE1BQU0sRUFBRTtBQUFDQyxJQUFBQSxJQUFJLEVBQUVKLE1BQU0sQ0FBQ0ssS0FBUCxDQUFhQyxRQUFwQjtBQUE4QkMsSUFBQUEsR0FBRyxFQUFFLE1BQW5DO0FBQTJDQyxJQUFBQSxRQUFRLEVBQUUsSUFBckQ7QUFBMkRDLElBQUFBLEtBQUssRUFBRTtBQUFsRSxHQURxQjtBQUU3QkMsRUFBQUEsSUFBSSxFQUFFO0FBQUNOLElBQUFBLElBQUksRUFBRU8sTUFBUDtBQUFlSCxJQUFBQSxRQUFRLEVBQUU7QUFBekIsR0FGdUI7QUFHN0JJLEVBQUFBLFVBQVUsRUFBRTtBQUFDUixJQUFBQSxJQUFJLEVBQUVTLElBQVA7QUFBYSxlQUFTQSxJQUFJLENBQUNDLEdBQTNCO0FBQWdDTixJQUFBQSxRQUFRLEVBQUU7QUFBMUMsR0FIaUI7QUFJN0JPLEVBQUFBLFFBQVEsRUFBRTtBQUFDWCxJQUFBQSxJQUFJLEVBQUVZLE9BQVA7QUFBZ0IsZUFBUyxLQUF6QjtBQUFnQ1IsSUFBQUEsUUFBUSxFQUFFO0FBQTFDLEdBSm1CO0FBSzdCUyxFQUFBQSxNQUFNLEVBQUU7QUFBQ2IsSUFBQUEsSUFBSSxFQUFFWSxPQUFQO0FBQWdCLGVBQVMsS0FBekI7QUFBZ0NSLElBQUFBLFFBQVEsRUFBRTtBQUExQyxHQUxxQjtBQU03QlUsRUFBQUEsV0FBVyxFQUFFO0FBQUNkLElBQUFBLElBQUksRUFBRUosTUFBTSxDQUFDSyxLQUFQLENBQWFDLFFBQXBCO0FBQThCRSxJQUFBQSxRQUFRLEVBQUUsSUFBeEM7QUFBK0NXLElBQUFBLE9BQU8sRUFBRSxrQkFBeEQ7QUFBNEVWLElBQUFBLEtBQUssRUFBRTtBQUFuRixHQU5nQjtBQU83QlcsRUFBQUEsZ0JBQWdCLEVBQUU7QUFDZGhCLElBQUFBLElBQUksRUFBRWlCLE1BRFE7QUFFZCxZQUFNLENBQUMsTUFBRCxFQUFTLE9BQVQ7QUFGUSxHQVBXO0FBVzdCQyxFQUFBQSxTQUFTLEVBQUVULElBWGtCO0FBWTdCVSxFQUFBQSxTQUFTLEVBQUVWLElBWmtCO0FBYTdCVyxFQUFBQSxTQUFTLEVBQUc7QUFBQ3BCLElBQUFBLElBQUksRUFBRVksT0FBUDtBQUFnQixlQUFTLEtBQXpCO0FBQWdDUixJQUFBQSxRQUFRLEVBQUU7QUFBMUM7QUFiaUIsQ0FBWCxDQUF0QjtBQWdCQU4sYUFBYSxDQUFDdUIsR0FBZCxDQUFrQixNQUFsQixFQUEwQixVQUFTQyxJQUFULEVBQWU7QUFDckMsTUFBSUMsV0FBVyxHQUFHLElBQUlkLElBQUosRUFBbEI7QUFDQSxPQUFLVSxTQUFMLEdBQWlCSSxXQUFqQjtBQUNBLE1BQUksQ0FBQyxLQUFLTCxTQUFWLEVBQ0ksS0FBS0EsU0FBTCxHQUFpQkssV0FBakI7QUFDSkQsRUFBQUEsSUFBSTtBQUNQLENBTkQ7O2VBUWdCLGtCQUFBRSxFQUFFLEVBQUk7QUFBRUEsRUFBQUEsRUFBRSxDQUFDQyxLQUFILENBQVMsU0FBVCxFQUFvQjNCLGFBQXBCO0FBQW1DLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnO1xyXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XHJcblxyXG5jb25zdCBtZXNzYWdlU2NoZW1hID0gbmV3IFNjaGVtYSh7XHJcbiAgICBhdXRob3I6IHt0eXBlOiBTY2hlbWEuVHlwZXMuT2JqZWN0SWQsIHJlZjogJ1VzZXInLCByZXF1aXJlZDogdHJ1ZSwgaW5kZXg6IHRydWV9LFxyXG4gICAgZGF0YToge3R5cGU6IE9iamVjdCwgcmVxdWlyZWQ6IHRydWV9LFxyXG4gICAgZGF0ZVNlbmRlZDoge3R5cGU6IERhdGUsIGRlZmF1bHQ6IERhdGUubm93LCByZXF1aXJlZDogdHJ1ZX0sIFxyXG4gICAgcmVjZWl2ZWQ6IHt0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiBmYWxzZSAscmVxdWlyZWQ6IHRydWV9LFxyXG4gICAgcmVhZGVkOiB7dHlwZTogQm9vbGVhbiwgZGVmYXVsdDogZmFsc2UgLHJlcXVpcmVkOiB0cnVlfSxcclxuICAgIGRlc3RpbmF0aW9uOiB7dHlwZTogU2NoZW1hLlR5cGVzLk9iamVjdElkLCByZXF1aXJlZDogdHJ1ZSwgIHJlZlBhdGg6ICdkZXN0aW5hdGlvbk1vZGVsJywgaW5kZXg6IHRydWV9LFxyXG4gICAgZGVzdGluYXRpb25Nb2RlbDoge1xyXG4gICAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgICBlbnVtOiBbJ1VzZXInLCAnR3JvdXAnXVxyXG4gICAgfSxcclxuICAgIGNyZWF0ZWRBdDogRGF0ZSxcclxuICAgIHVwZGF0ZWRBdDogRGF0ZSxcclxuICAgIGlzRGVsZXRlZDogIHt0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiBmYWxzZSAscmVxdWlyZWQ6IHRydWV9LFxyXG59KTtcclxuXHJcbm1lc3NhZ2VTY2hlbWEucHJlKCdzYXZlJywgZnVuY3Rpb24obmV4dCkge1xyXG4gICAgbGV0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcclxuICAgIHRoaXMudXBkYXRlZEF0ID0gY3VycmVudERhdGU7XHJcbiAgICBpZiAoIXRoaXMuY3JlYXRlZEF0KVxyXG4gICAgICAgIHRoaXMuY3JlYXRlZEF0ID0gY3VycmVudERhdGU7XHJcbiAgICBuZXh0KCk7XHJcbn0pO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgIGRiID0+IHsgZGIubW9kZWwoJ01lc3NhZ2UnLCBtZXNzYWdlU2NoZW1hKX1cclxuIl19